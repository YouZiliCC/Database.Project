{% extends "base.html" %}
{% block title %}{{ user.uname }} - ç”¨æˆ·è¯¦æƒ…{% endblock %}
{% block content %}
    <div class="container">
        <div class="info-section">
            <div class="info-header">
                {% if user.uimg %}
                    <img src="{{ user.uimg }}" alt="{{ user.uname }}" class="user-avatar">
                {% else %}
                    <div class="user-avatar-placeholder">{{ user.uname[0].upper() }}</div>
                {% endif %}
                <div>
                    <h2>{{ user.uname }}</h2>
                    <p class="text-muted">
                        {% if user.is_admin %}
                            <span class="badge badge-admin">ç®¡ç†å‘˜</span>
                        {% elif user.is_teacher %}
                            <span class="badge badge-teacher">æ•™å¸ˆ</span>
                        {% elif user.is_leader %}
                            <span class="badge badge-leader">ç»„é•¿</span>
                        {% else %}
                            <span class="badge">æ™®é€šç”¨æˆ·</span>
                        {% endif %}
                    </p>
                </div>
            </div>
            <div class="info-content">
                <div class="info-row">
                    <label>é‚®ç®±ï¼š</label>
                    <span>{{ user.email }}</span>
                </div>
                <div class="info-row">
                    <label>å­¦å·ï¼š</label>
                    <span>{{ user.sid }}</span>
                </div>
                <div class="info-row">
                    <label>æ‰€å±å·¥ä½œç»„ï¼š</label>
                    <span>
                        {% if user.group %}
                            <a href="{{ url_for('group.group_detail', gid=user.gid) }}">{{ user.group.gname }}</a>
                            {% if user.is_leader %}<span class="text-success">ï¼ˆç»„é•¿ï¼‰</span>{% endif %}
                        {% else %}
                            <span class="text-muted">æœªåŠ å…¥å·¥ä½œç»„</span>
                        {% endif %}
                    </span>
                </div>
                <div class="info-row">
                    <label>æ³¨å†Œæ—¶é—´ï¼š</label>
                    <span>{{ user.created_at.strftime("%Y-%m-%d %H:%M") if user.created_at else 'æœªçŸ¥' }}</span>
                </div>
            </div>
            {% if user.uinfo %}
                <div class="info-content">
                    <h3>ğŸ“ ä¸ªäººç®€ä»‹</h3>
                    <div class="markdown-content">{{ user.uinfo | markdown }}</div>
                </div>
            {% endif %}
            <div class="button-group mt-16">
                {% if current_user.is_authenticated %}
                    {% if current_user.uid == user.uid %}
                        <a href="{{ url_for("user.user_edit") }}" class="btn">ç¼–è¾‘ä¸ªäººä¿¡æ¯</a>
                        {% if current_user.gid %}
                            <a href="{{ url_for("group.my_group") }}" class="btn">æˆ‘çš„å·¥ä½œç»„</a>
                            <button class="btn btn-danger" onclick="leaveGroup()">é€€å‡ºå·¥ä½œç»„</button>
                        {% else %}
                            <a href="{{ url_for("group.group_list") }}" class="btn">åŠ å…¥å·¥ä½œç»„</a>
                        {% endif %}
                    {% endif %}
                    {% if current_user.is_admin %}
                        <button class="btn btn-danger" onclick="deleteUser('{{ user.uid }}')">åˆ é™¤ç”¨æˆ·</button>
                    {% endif %}
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}
{% block scripts %}<script src="{{ url_for('static', filename='js/user.js') }}"></script>{% endblock %}
